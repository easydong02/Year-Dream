{"cells":[{"cell_type":"markdown","metadata":{"id":"kv6gH7G01Pal"},"source":["## Numpy"]},{"cell_type":"markdown","metadata":{"id":"RQWkeQgD1Pam"},"source":["### 1. Numpy Array and Operation"]},{"cell_type":"markdown","metadata":{"id":"igGUA1oE1Pam"},"source":["- numpy의 기본적인 사용법에 대해서 배워봅니다.\n","\n","\n","- numpy에서 numpy.array를 만드는 여러가지 방법과 지원하는 연산자에 대해서 공부합니다."]},{"cell_type":"markdown","source":["### 1.1. Numpy Array creation"],"metadata":{"id":"ZzPzxgQ53PcS"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"MoD6QOXY1Pan","executionInfo":{"status":"ok","timestamp":1649996783157,"user_tz":-540,"elapsed":389,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}}},"outputs":[],"source":["# numpy 라이브러리를 불러옵니다.\n","import numpy as np\n"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"bqVEQaBP1Pan","executionInfo":{"status":"ok","timestamp":1649996813034,"user_tz":-540,"elapsed":276,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}}},"outputs":[],"source":["# 파이썬 리스트 선언\n","data = [1,2,3,4,5]\n"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"jADukVLG1Pan","executionInfo":{"status":"ok","timestamp":1649996827137,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}}},"outputs":[],"source":["# 파이썬 2차원 리스트(행렬) 선언\n","data2 = [[1,2],[3,4]]"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"jQq60ZfX1Pan","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649996840432,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"5e8ed6f9-62f3-4c54-c466-5e72d43cfc59"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5])"]},"metadata":{},"execution_count":6}],"source":["# 파이썬 list를 numpy array로 변환합니다.\n","arr = np.array(data)\n","# numpy array를 만드는 방식의 대부분은 파이썬 리스트를 np.array로 변환하는 방식입니다.\n","arr"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"eqbxPjfu1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649996858535,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"a456ee1d-d9fd-4012-cffa-4ed43c9904f4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2],\n","       [3, 4]])"]},"metadata":{},"execution_count":7}],"source":["# 2차원 리스트를 np.array로 만듭니다.\n","arr2 = np.array(data2) # data2라는 리스트를 numpy array로 만들어라.\n","arr2  #2차원 numpy array -> 행렬!"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"oMdYjtc21Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649996943711,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"6d2ef79c-2617-43e2-8200-e4465d429ae3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])"]},"metadata":{},"execution_count":10}],"source":["# 0부터 9까지 숫자를 자동으로 생성한 array\n","np.array(list(range(10)))\n","np.arange(10)"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"NwMSPz0Z1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649996953927,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"8b172b81-bf49-4d25-808a-22bb12abc46e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,\n","       27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43,\n","       44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n","       61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,\n","       78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,\n","       95, 96, 97, 98, 99])"]},"metadata":{},"execution_count":11}],"source":["# 10부터 99까지 숫자를 자동으로 생성한 array\n","np.arange(10,100)"]},{"cell_type":"markdown","metadata":{"id":"UFFwSitw1Pao"},"source":["### 1.2. Reshaping array"]},{"cell_type":"code","execution_count":56,"metadata":{"id":"-vcHHFl81Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998230453,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"90ab214b-0e92-455b-db19-bd9717f4e9f3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 3)"]},"metadata":{},"execution_count":56}],"source":["# 3 x 3 행렬을 만들어봅시다.\n","x = np.array([[1,2,3]])\n","x.shape"]},{"cell_type":"markdown","source":["x = np.array([1,2,3])\n","x.shape 랑\n","\n","x = np.array([[1,2,3]])\n","x.shape 랑 뭔차이?"],"metadata":{"id":"eOrhSOnhjrVQ"}},{"cell_type":"markdown","source":[""],"metadata":{"id":"Ie9VGRzxjpZg"}},{"cell_type":"code","execution_count":17,"metadata":{"id":"HChX3Sv91Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997181710,"user_tz":-540,"elapsed":285,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"5efcc281-6ad9-411f-d61d-2fe549953041"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6],\n","       [7, 8, 9]])"]},"metadata":{},"execution_count":17}],"source":["# reshape을 이용하여 만들어봅시다.\n","np.arange(1,10).reshape(3,3) #( , 9) -> (3,3)"]},{"cell_type":"code","source":["# row vector를 column vector로\n","np.arange(6).reshape(6,1)"],"metadata":{"id":"jKHQRaFx5QFT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997216091,"user_tz":-540,"elapsed":4,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"e2e66f0e-9fb0-43e4-954a-77907e19653e"},"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0],\n","       [1],\n","       [2],\n","       [3],\n","       [4],\n","       [5]])"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","source":["# 펼치기 \n","x.reshape(-1,) # -1은 마지막이니까"],"metadata":{"id":"Jre4TnZT5YwK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997337655,"user_tz":-540,"elapsed":312,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"03564664-764f-45a1-edbb-72d80ecdb9d8"},"execution_count":26,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5, 6, 7, 8, 9])"]},"metadata":{},"execution_count":26}]},{"cell_type":"markdown","metadata":{"id":"MMrKtZy-1Pao"},"source":["### 1.3. Concatenation of arrays"]},{"cell_type":"code","execution_count":31,"metadata":{"id":"6g1bOHDn1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997490318,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"63fafbf9-761e-4434-93c1-f4020ecedaa7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5, 6])"]},"metadata":{},"execution_count":31}],"source":["arr1 = np.array([1, 2, 3])\n","arr2 = np.array([4, 5, 6])\n","# arr1 + arr2 = ?\n","arr1 + arr2  #이것은 리스트와 달리 벡터연산을 해버림.\n","\n","# arr1와 arr2를 합칩니다\n","np.concatenate([arr1,arr2] ,axis=0) #이어 붙이기"]},{"cell_type":"code","execution_count":29,"metadata":{"id":"ePV80Pwx1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997459743,"user_tz":-540,"elapsed":260,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"24b132fe-ba10-4d1c-d85a-9ff5c98462d3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6]])"]},"metadata":{},"execution_count":29}],"source":["# stacking vertically\n","np.vstack([arr1,arr2])"]},{"cell_type":"code","execution_count":30,"metadata":{"id":"xcY9pR2M1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997473704,"user_tz":-540,"elapsed":255,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"80ba505b-de18-486b-d020-c1adb4c3c999"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5, 6])"]},"metadata":{},"execution_count":30}],"source":["# stacking horizontally\n","np.hstack([arr1,arr2])"]},{"cell_type":"markdown","metadata":{"id":"1Pioy4a-1Pap"},"source":["## 1.4. Array Arithmetic (like vector) --> Universal Function"]},{"cell_type":"code","execution_count":32,"metadata":{"id":"sxjF6pdh1Pap","executionInfo":{"status":"ok","timestamp":1649997548639,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}}},"outputs":[],"source":["# v1 = (1, 2, 3), v2 = (4, 5, 6) 벡터 2개 생성하기.\n","v1 = np.array([1,2,3])\n","v2= np.array([4,5,6])"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"KFKEKB711Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997569685,"user_tz":-540,"elapsed":292,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"2321b416-c065-40d0-c3f4-dbfd81888b60"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[1, 2, 3, 4, 5, 6]"]},"metadata":{},"execution_count":33}],"source":["# 리스트로 더하기 연산해보기\n","L = [1,2,3]\n","L2 = [4,5,6]\n","L + L2"]},{"cell_type":"code","execution_count":34,"metadata":{"id":"UiDh2wZX1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997574115,"user_tz":-540,"elapsed":4,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"6e30b77a-6e09-49ad-cebe-c486398bfee0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([5, 7, 9])"]},"metadata":{},"execution_count":34}],"source":["#  vector addition\n","v1 + v2"]},{"cell_type":"code","execution_count":35,"metadata":{"id":"z1uh1zIW1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997592349,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"e7258efe-d598-4c53-d3eb-bcb9f3f01bed"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([-3, -3, -3])"]},"metadata":{},"execution_count":35}],"source":["#  vector subtraction\n","v1 -v2"]},{"cell_type":"code","execution_count":36,"metadata":{"id":"Kp3n7JU91Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997599884,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"6c99951e-a65f-48d2-9400-698a401ba9cc"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([ 4, 10, 18])"]},"metadata":{},"execution_count":36}],"source":["# (not vector operation) elementwise multiplication\n","v1*v2"]},{"cell_type":"code","execution_count":37,"metadata":{"id":"WQDxd6ew1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997615111,"user_tz":-540,"elapsed":263,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"65944fdf-c682-4bc3-d4f7-fb09bd61ca53"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.25, 0.4 , 0.5 ])"]},"metadata":{},"execution_count":37}],"source":["# (not vector operation) elementwise division\n","v1/v2"]},{"cell_type":"code","execution_count":38,"metadata":{"id":"Kh9DEujN1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997627722,"user_tz":-540,"elapsed":271,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"c7b7620c-b8ef-4cb6-e7e4-c85330a8c3e8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["32"]},"metadata":{},"execution_count":38}],"source":["# dot product\n","v1 @ v2 # 1x4 + 2x5 + 3x6"]},{"cell_type":"markdown","metadata":{"id":"Dp11IV1l1Pap"},"source":["### 1.5. Broadcast and Universal Function"]},{"cell_type":"markdown","metadata":{"id":"lbGKwuWf1Pap"},"source":["- 서로 크기가 다른 numpy array를 연산할 때, 자동으로 연산을 전파(broadcast)해주는 기능. 행렬곱 연산을 할 때 편리하다."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"g8pG0d-V1Paq"},"outputs":[],"source":["arr1 = np.array([1,2,3])"]},{"cell_type":"code","execution_count":42,"metadata":{"id":"CQDgu7vG1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997736325,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"aa2b8e75-9fa1-420b-c410-16b3ff19ef8c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(2, 3)"]},"metadata":{},"execution_count":42}],"source":["arr2 = np.array([[-1,-1,-1],\n","                [-1,-1,-1]]) \n","arr2.shape"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"-4EWUAZB1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997751124,"user_tz":-540,"elapsed":280,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"2c551c38-df18-46e9-de6e-cf3e824037fa"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0, 1, 2],\n","       [0, 1, 2]])"]},"metadata":{},"execution_count":43}],"source":["# 2개의 array를 더해보면?\n","arr1 + arr2 # 2->2->3(v)"]},{"cell_type":"code","execution_count":44,"metadata":{"id":"EvOolsHz1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649997764403,"user_tz":-540,"elapsed":260,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"09c76fb6-62a0-4342-cace-c87b8c85cf4b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-1, -2, -3],\n","       [-1, -2, -3]])"]},"metadata":{},"execution_count":44}],"source":["# 2개의 array를 곱해보면? (**)\n","arr1 * arr2"]},{"cell_type":"markdown","source":["- Universal Function : broadcast 기능을 확장해서, numpy array의 모든 원소에 동일한 함수를 반복문으로 적용한 것과 같은 효과를 내는 기능."],"metadata":{"id":"Rch_pHQW55S-"}},{"cell_type":"code","source":["# f = lambda x : 1/x\n","f = lambda x : 1/x\n","\n","arr1 = np.array([1.0,2.0,3.0])\n","print(arr1.shape)\n","\n","for i in range(arr1.shape[0]):\n","    arr1[i] = f(arr1[i])\n","print(arr1)\n","\n","\n","arr1= np.array([1. , 2. , 3.])\n","print(1/arr1)  #universal func"],"metadata":{"id":"AeXAfqUI6H0V","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998327782,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"6371301c-a891-49e2-c519-f2b896be5f9f"},"execution_count":58,"outputs":[{"output_type":"stream","name":"stdout","text":["(3,)\n","[1.         0.5        0.33333333]\n","[1.         0.5        0.33333333]\n"]}]},{"cell_type":"code","execution_count":61,"metadata":{"id":"xt20aKq21Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998389804,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"a92eeb4e-5d8c-4adc-8f43-497d8b8c18d8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([51., 60., 69.])"]},"metadata":{},"execution_count":61}],"source":["# f = lambda x : x + 2\n","arr1 = arr1 + 2\n","arr1 = arr1 *3\n","arr1"]},{"cell_type":"markdown","metadata":{"id":"JQ9vQmo-1Paq"},"source":["### 1.6. Indexing\n","- numpy array의 indexing은 python list의 indexing과 같다!\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"C2U2Y3Sz1Paq"},"outputs":[],"source":["arr1 = np.arange(10)"]},{"cell_type":"code","execution_count":62,"metadata":{"id":"5WULHYrI1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998452917,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"f81777ab-a96c-4b9c-b16f-0905c6ea4f06"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["51.0"]},"metadata":{},"execution_count":62}],"source":["# 첫번째 원소\n","arr1[0]"]},{"cell_type":"code","execution_count":63,"metadata":{"id":"_N-nEw7V1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998458696,"user_tz":-540,"elapsed":253,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"ab93a4ce-8a44-4a8a-8abf-c25a1d097c6b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["69.0"]},"metadata":{},"execution_count":63}],"source":["# 마지막 원소\n","arr1[-1]"]},{"cell_type":"code","execution_count":64,"metadata":{"id":"wNQa8qoO1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998463344,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"1b27665b-89c5-43d4-85df-f3dd5cd98101"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([51., 60., 69.])"]},"metadata":{},"execution_count":64}],"source":["# 앞에서부터 원소 3개 slicing\n","arr1[:3]"]},{"cell_type":"code","execution_count":66,"metadata":{"id":"29pYfFvL1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998486625,"user_tz":-540,"elapsed":282,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"96f14ddb-79a2-4c2b-9f56-c459696cd477"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(3, 4)"]},"metadata":{},"execution_count":66}],"source":["arr2 = np.array([[1, 2, 3, 4],\n","               [5, 6, 7, 8],\n","               [9, 10, 11, 12]])\n","arr2.shape"]},{"cell_type":"code","execution_count":69,"metadata":{"id":"p8EFXNq91Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998553985,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"a3e39958-95ac-47d8-cd4c-a54e6017fccd"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["7"]},"metadata":{},"execution_count":69}],"source":["# arr2의 2row, 3column 원소 = 7\n","arr2[1][2]\n","\n","arr2[1,2] # numpy array indexing에서 추가된 것!"]},{"cell_type":"code","execution_count":73,"metadata":{"id":"OVgw4bT11Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998649141,"user_tz":-540,"elapsed":4,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"dd843b1c-47ad-4807-d956-9654e9805c50"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([ 3,  7, 11])"]},"metadata":{},"execution_count":73}],"source":["# arr2의 세번째 column [3, 7, 11]\n","arr2[ : , 2] #원래는 [0:3]"]},{"cell_type":"code","execution_count":76,"metadata":{"id":"krLo7Tvg1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649998739797,"user_tz":-540,"elapsed":257,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"b4437063-4253-4d08-dc3c-7c5e3ffae131"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[6]])"]},"metadata":{},"execution_count":76}],"source":["# arr2의 두번째 row\n","arr2[1,:]\n","\n","arr2[1, :2 ] #물론 슬라이싱도 가능\n","\n","arr2[1:2, 1:2]"]},{"cell_type":"markdown","metadata":{"id":"nb3NOpgU1Par"},"source":["## 2. Numpy Methods\n","\n","- numpy에서 사용되는 여러가지 함수들을 사용해봅시다."]},{"cell_type":"markdown","metadata":{"id":"wsDCnH9Q1Par"},"source":["### 2.1. Math Functions "]},{"cell_type":"code","execution_count":77,"metadata":{"id":"Pme3p6FQ1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999540318,"user_tz":-540,"elapsed":428,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"f50d1c0e-8c65-49ff-d685-bc038c4fdfe4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-0.07510166,  0.6131468 ,  0.54283774],\n","       [-2.59859418, -0.45332887,  1.39785641],\n","       [ 0.76676502, -1.10840171, -0.57626895],\n","       [ 1.28513548,  0.1992019 , -0.17929667],\n","       [ 2.11819376, -1.55510618, -0.9425675 ]])"]},"metadata":{},"execution_count":77}],"source":["# 표준정규분포에서 random sampling을 한 원소를 가지는 5x3 행렬을 만든다.\n","mat1 = np.random.randn(5,3)\n","mat1"]},{"cell_type":"code","execution_count":79,"metadata":{"id":"YnWulebZ1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999665858,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"589fd23c-762b-480d-b427-88ebc4a83e7e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.07510166, 0.6131468 , 0.54283774],\n","       [2.59859418, 0.45332887, 1.39785641],\n","       [0.76676502, 1.10840171, 0.57626895],\n","       [1.28513548, 0.1992019 , 0.17929667],\n","       [2.11819376, 1.55510618, 0.9425675 ]])"]},"metadata":{},"execution_count":79}],"source":["# mat1에 절대값 씌우기\n","np.abs(mat1)"]},{"cell_type":"code","source":["# mat1 제곱하기\n","np.square(mat1)"],"metadata":{"id":"LEt94K-t6sdK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999677452,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"821c1fcd-1cf1-4bd1-fa00-0df74d2e6c2d"},"execution_count":80,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[5.64025937e-03, 3.75949001e-01, 2.94672809e-01],\n","       [6.75269173e+00, 2.05507062e-01, 1.95400253e+00],\n","       [5.87928593e-01, 1.22855435e+00, 3.32085902e-01],\n","       [1.65157321e+00, 3.96813988e-02, 3.21472966e-02],\n","       [4.48674481e+00, 2.41835523e+00, 8.88433500e-01]])"]},"metadata":{},"execution_count":80}]},{"cell_type":"code","source":["# mat1의 제곱근 구하기\n","np.sqrt(mat1)   #nan = not a number"],"metadata":{"id":"mFldaHe_6wHC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999710053,"user_tz":-540,"elapsed":4,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"a2a1588c-4496-4690-c4af-208b6a148112"},"execution_count":83,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: RuntimeWarning: invalid value encountered in sqrt\n","  \n"]},{"output_type":"execute_result","data":{"text/plain":["array([[       nan, 0.78303691, 0.73677523],\n","       [       nan,        nan, 1.18230978],\n","       [0.8756512 ,        nan,        nan],\n","       [1.13363816, 0.44632041,        nan],\n","       [1.45540158,        nan,        nan]])"]},"metadata":{},"execution_count":83}]},{"cell_type":"code","source":["# linear algebra functions\n","vec = np.array([1,2,2])\n","\n","# 1. norm\n","np.linalg.norm(vec) #vector L2 norm\n","\n","# 2. eigenvalue\n","mat = np.array([[1,2],[4,5]])\n","np.linalg.eig(mat)"],"metadata":{"id":"khqI2kwA62Ez","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999861893,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"15009b78-8292-4f9d-c42e-0c3815ec5370"},"execution_count":89,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(array([-0.46410162,  6.46410162]), array([[-0.80689822, -0.34372377],\n","        [ 0.59069049, -0.9390708 ]]))"]},"metadata":{},"execution_count":89}]},{"cell_type":"markdown","metadata":{"id":"Tk5S0yOf1Par"},"source":["### 2.2. Aggregation functions "]},{"cell_type":"code","execution_count":91,"metadata":{"id":"b0ei5LJ51Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999940214,"user_tz":-540,"elapsed":260,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"79f0bebf-f219-4b5f-9aa0-5d078d89d2ac"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.62212505, 0.17235398],\n","       [0.8082974 , 0.10324764],\n","       [0.37808648, 0.45945173]])"]},"metadata":{},"execution_count":91}],"source":["mat2 = np.random.rand(3, 2)\n","mat2"]},{"cell_type":"code","execution_count":94,"metadata":{"id":"hMKOS5O51Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1649999991831,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"550187d9-3067-4ece-943c-4c135ddf17f9"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1.80850892, 0.73505334])"]},"metadata":{},"execution_count":94}],"source":["# Summation\n","np.sum(mat2)\n","np.sum(mat2,axis=0) #열 방향"]},{"cell_type":"code","execution_count":97,"metadata":{"id":"OdJZdrx_1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000042960,"user_tz":-540,"elapsed":270,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"8688d94a-6231-406a-d321-2c5363b34dc2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.39723951, 0.45577252, 0.4187691 ])"]},"metadata":{},"execution_count":97}],"source":["# mean\n","np.mean(mat2)\n","np.mean(mat2, axis=0)\n","np.mean(mat2, axis=1)"]},{"cell_type":"code","execution_count":98,"metadata":{"id":"78xMuXMY1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000055794,"user_tz":-540,"elapsed":6,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"c2dabe9b-6c33-40e0-a4f9-23bfbc10fd94"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.24375898792822734"]},"metadata":{},"execution_count":98}],"source":["# std\n","np.std(mat2)"]},{"cell_type":"code","execution_count":100,"metadata":{"id":"KzfPurFc1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000089998,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"24136611-0cd4-450c-c17b-1b290e9f139a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.62212505, 0.8082974 , 0.45945173])"]},"metadata":{},"execution_count":100}],"source":["# min, max\n","np.min(mat2,axis=0)\n","np.max(mat2,axis=1)"]},{"cell_type":"code","execution_count":102,"metadata":{"id":"YtRtiSG31Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000135876,"user_tz":-540,"elapsed":3,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"7ef072e8-f216-495e-80e2-76537603ceeb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 1, 0])"]},"metadata":{},"execution_count":102}],"source":["# 최소값이 있는 Index\n","np.argmin(mat2,axis=1)"]},{"cell_type":"code","execution_count":103,"metadata":{"id":"0cndLCKl1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000184875,"user_tz":-540,"elapsed":5,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"8b240fc8-a16c-4bbf-836f-fc157fe5077f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0, 1])"]},"metadata":{},"execution_count":103}],"source":["# 최대값이 있는 Index\n","np.argmax(mat2,axis=1)"]},{"cell_type":"code","execution_count":109,"metadata":{"id":"y2LVvF5b1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000379179,"user_tz":-540,"elapsed":4,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"ea441c12-824a-4c11-b26d-eddb1bad2195"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.37808648, 0.10324764],\n","       [0.62212505, 0.17235398],\n","       [0.8082974 , 0.45945173]])"]},"metadata":{},"execution_count":109}],"source":["# 그냥 정렬 (오름차순 정렬만 지원합니다)\n","np.sort(mat2, axis=0)\n","\n","#내림차순?\n","#np.sort(mat2,axis=0)[::-1]"]},{"cell_type":"code","execution_count":110,"metadata":{"id":"mLeMOv7f1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000382045,"user_tz":-540,"elapsed":270,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"66f6f45f-ce0c-496e-98ad-4007804d31d4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[2, 1],\n","       [0, 0],\n","       [1, 2]])"]},"metadata":{},"execution_count":110}],"source":["# index를 정렬\n","np.argsort(mat2,axis=0) #정렬되기 전 인덱스 반환"]},{"cell_type":"markdown","metadata":{"id":"2a2AgVdm1Pas"},"source":["## 3. \bPerformance Check"]},{"cell_type":"markdown","metadata":{"id":"ciO_FLLW1Pas"},"source":["- Universal Function 기능을 통해 반복문을 사용한 것보다 훨씬 빠른 성능을 냅니다.\n","\n","\n","- 직접 실험을 통해 그 차이를 확인해보겠습니다."]},{"cell_type":"code","execution_count":112,"metadata":{"id":"oVBZX1U31Pas","executionInfo":{"status":"ok","timestamp":1650000524237,"user_tz":-540,"elapsed":323,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}}},"outputs":[],"source":["np.random.seed(0) #random에 대한 실행결과를 고정\n","\n","def reverse_num(values):\n","    output = np.empty(len(values))\n","    \n","    for i in range(len(values)):\n","        output[i] = 1.0 / values[i]\n","    \n","    return output"]},{"cell_type":"code","execution_count":113,"metadata":{"id":"aagBlNXs1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000582371,"user_tz":-540,"elapsed":269,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"296d66b9-1859-42be-d272-7ed92f9e0bc7"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([45, 48, 65, ..., 93, 62, 19])"]},"metadata":{},"execution_count":113}],"source":["# 1부터 100까지 범위에서 1000000개를 랜덤으로 뽑아서 array를 만듭니다.\n","big_array = np.random.randint(1,100,1000000)\n","big_array"]},{"cell_type":"code","execution_count":114,"metadata":{"id":"VMyEUiVM1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000596827,"user_tz":-540,"elapsed":12945,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"de6f0284-5fee-40bb-8196-ed362632b640"},"outputs":[{"output_type":"stream","name":"stdout","text":["1 loop, best of 5: 2.09 s per loop\n"]}],"source":["%timeit reverse_num(big_array)"]},{"cell_type":"code","execution_count":115,"metadata":{"id":"k7PvHI7-1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1650000598316,"user_tz":-540,"elapsed":1491,"user":{"displayName":"DONG HEE SHIN","userId":"03810046734519443823"}},"outputId":"619f48d8-b324-43dd-d5b0-3995eefcc220"},"outputs":[{"output_type":"stream","name":"stdout","text":["100 loops, best of 5: 2.39 ms per loop\n"]}],"source":["%timeit 1.0 / big_array"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_11lEint1Pas"},"outputs":[],"source":[""]}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.2"},"colab":{"name":"Chapter.02 데이터 분석 라이브러리-03. Numpy method (실습).ipynb의 사본","provenance":[{"file_id":"1KqBcsoK1g3Txiy-IRWO8t_zIE6iT6J6M","timestamp":1649996613769}],"collapsed_sections":[]}},"nbformat":4,"nbformat_minor":0}